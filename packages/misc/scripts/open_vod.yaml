---
alias: Open VOD
variables:
  media_player_content_id: >-
    {% if app_name is defined and app_name | length %}
      {{ app_name }}
    {% endif %}
sequence:
  - service: media_player.turn_on
    data_template:
      entity_id: "{{ sensor.media_player_id_by_occupancy }}"

  - if:
      - condition: template
        value_template: "{{ media_player_content_id | length > 0 }}"
    then:
      - action: media_player.play_media
        data:
          media_content_type: app
          media_content_id: "{{ media_player_content_id }}"
        target:
          entity_id: "{{ sensor.media_player_id_by_occupancy }}"

  - service: media_player.volume_set
    data_template:
      entity_id: "{{ sensor.media_player_id_by_occupancy }}"
      volume_level: 0.22
