---
alias: stairs_turn_on_lights_when_occupied
description: Turn on the stair lights when they are occupied
id: 80741f39-9e04-408b-90bf-dcde194198bb

mode: restart
max_exceeded: silent

trigger:
  - platform: state
    entity_id:
      - binary_sensor.stairway_occupied
    from: "off"
    to: "on"

condition:
  - condition: numeric_state
    entity_id: sensor.presence_sensor_fp2_livingroom_light_level
    below: 10

action:
  - alias: "Turn on the light"
    service: light.turn_on
    target:
      entity_id: light.stairway

  - alias: "Wait until there is no motion from device"
    wait_for_trigger:
      platform: state
      entity_id: binary_sensor.stairway_occupied
      from: "on"
      to: "off"

  - alias: "Wait the number of seconds that has been set"
    delay: 20

  - alias: "Turn off the light"
    service: light.turn_off
    target:
      entity_id: light.stairway
